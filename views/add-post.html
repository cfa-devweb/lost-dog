{% extends "layouts/base.html" %}

{% block css %}
<style>
    .aligneVertical {
        align-self: center;
    }

    .preview {
        max-width: 200px;
        max-height: 200px;
        display: block;
    }

    /* #F5E400 couleur logo */
</style>
{% endblock %}

{% block content %}


<main>


    <form class="container " action="post">
        <div class=" row">
            <div class="col-lg-12">
                <div class="row mt-4">
                    <div class="col-lg-6">
                        <div class="form-group">
                            <label for="ftitle" class="font-default ">Titre de l'annonce</label>
                            <input class="form-control mb-3 js-input-title" type="text" name="" id="ftitle"
                                min-length="1" max-length="30">
                        </div>

                        <div class="form-group">
                            <label for="nameAnimal" class="font-default">Nom de animal</label>
                            <input class="form-control mb-3 js-input-title" type="text" name="nameAnimal"
                                id="nameAnimal" min-length="1" max-length="30">
                        </div>

                        <div class="form-group">
                            <label for="ftype-animal" class="font-default">Animal</label>
                            <select class="form-control mb-3" id="ftype-animal">
                                <option value="">--Choisi ton option--</option>
                                <option value="dog">Chien</option>
                                <option value="cat">Chat</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="fsituation-animal" class="font-default">Situation</label>
                            <select class="form-control mb-3" id="fsituation-animal">
                                <option value="">--Choisi ton option--</option>
                                <option value="lost">Perdu</option>
                                <option value="found">Trouve</option>
                                <option value="adopted">Adopte</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="fsex-animal" class="font-default">Sex</label>
                            <select class="form-control mb-3" id="fsex-animal">
                                <option value="">--Choisi ton option--</option>
                                <option value="male">Male</option>
                                <option value="female">Femelle</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="fage-animal" class="font-default">Age</label>
                            <input class="form-control mb-3" type="number" name="" id="fage-animal" min="0" max="255">
                        </div>

                        <div class="form-group">
                            <label for="fnumber" class="font-default">Numéro de télèphone</label>
                            <input class="form-control mb-3" type="text" minlength="6" maxlength="6" id="numberPhone">
                        </div>
                        </span>

                    </div>
                    <div class="col-lg-6 aligneVertical">
                        <div class="container h-75">
                            <img src="images/icon-photo.png"
                                alt="cette image représente un appareil photo pour rajouter la photo d'un chien "
                                class="rounded mx-auto d-block" width="100">
                            <div class=" text-center">
                                <div class="">
                                    <h3 class="font-title font-default">Photo principale</h3>
                                    <span class="text-uppercase font-default">Ajouter une photo</span>
                                    <div class="container">
                                        <input type="file" class="border border-dark border-1  w-100"
                                            data-preview=".preview" id="fimage-animal">
                                    </div>
                                    <img class="preview m-auto"/>
                                    <small>3mo max</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-12 mb-4">
                <div class="form-group">
                    <label for="fcomentaire" class="font-default">Description</label>
                    <textarea class="form-control mb-4" name="story" rows="5" cols="33" id="description"></textarea>
                    <div class="custom-control custom-checkbox mb-2">
                        <input type="checkbox" class="custom-control-input" id="defaultChecked2">
                        <label class="custom-control-label" for="defaultChecked2" id="urgentDog">Urgent cette animal
                            risque d'étre
                            euthanasier</label>
                    </div>
                    <input class="btn btn-primary mb-3" type="submit" value="Envoyer">
                </div>
            </div>
        </div>

        {{ captcha | safe }}
    </form>
</main>
{% endblock %}

{% block js %}

<script src="https://code.jquery.com/jquery-3.5.1.js" integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc="
    crossorigin="anonymous"></script>
<script type="text/javascript">
    // reCapatcha Google
    function resRecaptcha(token) {
        var input = document.createElement('input');
        input.setAttribute('type', 'hidden');
        input.setAttribute('name', 'g-recaptcha-response');
        input.setAttribute('value', token);
        document.getElementsByTagName('form')[0].appendChild(input);
    }

    // Envoi des données aux Back-End
    $('form').submit(function (event) {
        event.preventDefault();
        $title = $('#ftitle').val();
        $nameAnimal = $('#nameAnimal').val();
        $animal = $('#ftype-animal').val();
        $situation = $('#fsituation-animal').val();
        $sexe = $('#fsex-animal').val();
        $age = $('#fage-animal').val();
        $tel = $('#numberPhone').val();
        $description = $('#description').val();
        $img = $('#fimage-animal').get(0).files;
        $image = $img[0].name;

        $('form').submit(function (event) {
            event.preventDefault();
            $.post('/annonce', {
                    title: $title,
                    nameAnimal: $nameAnimal,
                    animal: $animal,
                    situation: $situation,
                    sexe: $sexe,
                    age: $age,
                    tel: $tel,
                    description: $description,
                    image: $image
                }, function (data) {
                    // alert('Votre publication a bien été ajoutée');
                    console.log(data);
                },
                'json');
        })
    })

    // Titre de l'anonce
    $("#ftitle")
        .on("mouseenter", function () {
            $(this).css({
                "background-color": "seashell",
                "font-weight": "bolder",
                "border-bottom": "2px solid #F5E400"
            });
        })
        .on("mouseleave", function () {
            var styles = {
                backgroundColor: "",
                fontWeight: "",
                borderBottom: ""
            };
            $(this).css(styles);
        });

    // Nom de animal
    $("#nameAnimal")
        .on("mouseenter", function () {
            $(this).css({
                "background-color": "seashell",
                "font-weight": "bolder",
                "border-bottom": "2px solid #F5E400"
            });
        })
        .on("mouseleave", function () {
            var styles = {
                backgroundColor: "",
                fontWeight: "",
                borderBottom: ""
            };
            $(this).css(styles);
        });

    // Animal type
    $("#ftype-animal")
        .on("mouseenter", function () {
            $(this).css({
                "background-color": "seashell",
                "font-weight": "bolder",
                "border-bottom": "2px solid #F5E400"
            });
        })
        .on("mouseleave", function () {
            var styles = {
                backgroundColor: "",
                fontWeight: "",
                borderBottom: ""
            };
            $(this).css(styles);
        });
    // Animal Situation
    $("#fsituation-animal")
        .on("mouseenter", function () {
            $(this).css({
                "background-color": "seashell",
                "font-weight": "bolder",
                "border-bottom": "2px solid #F5E400"
            });
        })
        .on("mouseleave", function () {
            var styles = {
                backgroundColor: "",
                fontWeight: "",
                borderBottom: ""
            };
            $(this).css(styles);
        });
    // Animal SEX
    $("#fsex-animal")
        .on("mouseenter", function () {
            $(this).css({
                "background-color": "seashell",
                "font-weight": "bolder",
                "border-bottom": "2px solid #F5E400"
            });
        })
        .on("mouseleave", function () {
            var styles = {
                backgroundColor: "",
                fontWeight: "",
                borderBottom: ""
            };
            $(this).css(styles);
        });
    // Animal Age
    $("#fage-animal")
        .on("mouseenter", function () {
            $(this).css({
                "background-color": "seashell",
                "font-weight": "bolder",
                "border-bottom": "2px solid #F5E400"
            });
        })
        .on("mouseleave", function () {
            var styles = {
                backgroundColor: "",
                fontWeight: "",
                borderBottom: ""
            };
            $(this).css(styles);
        });
    // Number phone
    $("#numberPhone")
        .on("mouseenter", function () {
            $(this).css({
                "background-color": "seashell",
                "font-weight": "bolder",
                "border-bottom": "2px solid #F5E400"
            });
        })
        .on("mouseleave", function () {
            var styles = {
                backgroundColor: "",
                fontWeight: "",
                borderBottom: ""
            };
            $(this).css(styles);
        });
    // Description
    $("#description")
        .on("mouseenter", function () {
            $(this).css({
                "background-color": "seashell",
                "font-weight": "bolder",
                "border-bottom": "2px solid #F5E400"
            });
        })
        .on("mouseleave", function () {
            var styles = {
                backgroundColor: "",
                fontWeight: "",
                borderBottom: ""
            };
            $(this).css(styles);
        });
    // URGENCE
    // $(document).ready(function () {
    //         $('input[id="urgentDog"]').click(function () {
    //             if ($(this).prop("checked") == true) {
    //                 //Active un élément 
    //                 $('#urgentDog').val("OUI");
    //             } else if ($(this).prop("checked") == false) {
    //                 //Désactive un élément
    //                 $('#urgentDog').val("NON");
    //             }
    //         });
    //     });

    // Apercue de upload
    $("input[data-preview]").change(function () {
        var $input = $(this);
        var fileReader = new FileReader();
        fileReader.readAsDataURL(this.files[0]);
        fileReader.onload = function (fileEvent) {
            $($input.data('preview')).attr('src', fileEvent.target.result);
        };
    });
</script>
{% endblock %}